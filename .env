# IDS Engine - Environment Configuration
# Copy this file to .env and update values for your environment

# ========== API Configuration ==========
API_HOST=0.0.0.0
API_PORT=5000
API_DEBUG=false
API_WORKERS=4
API_TIMEOUT=30

# ========== Database Configuration ==========
# For production use PostgreSQL
# For development can use SQLite
DATABASE_URL=sqlite:///ids_engine.db
# DATABASE_URL=postgresql://user:password@localhost:5432/ids_db

# ========== Packet Capture Configuration ==========
CAPTURE_INTERFACE=eth0
CAPTURE_MODE=simulation  # simulation or live
PACKET_BUFFER_SIZE=10000
MAX_PACKET_SIZE=65535
BPF_FILTER=  # Empty = capture all

# ========== Detection Configuration ==========
# Signature-based detection
SIGNATURE_RULES_ENABLED=true
RULES_PATH=./rules/
AUTO_LOAD_RULES=true

# Anomaly detection
ANOMALY_DETECTION_ENABLED=true
ANOMALY_THRESHOLD=0.7
ANOMALY_CONTAMINATION_RATE=0.1
ANOMALY_MODEL_PATH=./ml_models/anomaly_model.pkl

# ========== Alert Configuration ==========
ALERT_RETENTION_DAYS=30
MAX_ALERTS_IN_MEMORY=1000
ALERT_SEVERITY_THRESHOLD=low  # all, high, medium, low
ENABLE_EMAIL_ALERTS=false
ENABLE_SYSLOG_ALERTS=false

# ========== Performance Tuning ==========
ENABLE_CACHING=true
CACHE_TTL_SECONDS=300
MAX_ALERTS_PER_QUERY=1000
QUERY_TIMEOUT_SECONDS=30

# ========== Logging Configuration ==========
LOG_LEVEL=INFO
LOG_FILE=ids_engine.log
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s
LOG_MAX_SIZE_MB=100
LOG_BACKUP_COUNT=10

# ========== Security Configuration ==========
API_KEY_REQUIRED=false
API_KEY=your-secret-key-here
CORS_ALLOWED_ORIGINS=*
RATE_LIMIT_ENABLED=false
RATE_LIMIT_REQUESTS_PER_MINUTE=100

# ========== Integration Configuration ==========
SIEM_INTEGRATION=false
SIEM_ENDPOINT=http://siem-server:5000/api/alerts
ELASTICSEARCH_ENABLED=false
ELASTICSEARCH_HOST=localhost
ELASTICSEARCH_PORT=9200

# ========== Feature Flags ==========
ENABLE_ML_ANOMALY_DETECTION=true
ENABLE_SIGNATURE_DETECTION=true
ENABLE_STATISTICAL_ANOMALY=true
ENABLE_RULE_LEARNING=false
ENABLE_AUTO_TUNING=false

# ========== Testing Configuration ==========
TEST_MODE=false
GENERATE_SYNTHETIC_PACKETS=true
SYNTHETIC_PACKETS_PER_SECOND=50
SIMULATE_ATTACKS=false
